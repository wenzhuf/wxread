# config.py 自定义配置,包括阅读次数、推送token的填写
import os
import re

"""
可修改区域
默认使用本地值如果不存在从环境变量中获取值
"""

# 阅读次数 默认120次/60分钟
READ_NUM = int(os.getenv('READ_NUM') or 120)
# 需要推送时可选，可选pushplus、wxpusher、telegram
PUSH_METHOD = "" or os.getenv('PUSH_METHOD')
# pushplus推送时需填
PUSHPLUS_TOKEN = "" or os.getenv("PUSHPLUS_TOKEN")
# telegram推送时需填
TELEGRAM_BOT_TOKEN = "" or os.getenv("TELEGRAM_BOT_TOKEN")
TELEGRAM_CHAT_ID = "" or os.getenv("TELEGRAM_CHAT_ID")
# wxpusher推送时需填
WXPUSHER_SPT = "" or os.getenv("WXPUSHER_SPT")
# read接口的bash命令，本地部署时可对应替换headers、cookies
curl_str = os.getenv('WXREAD_CURL_BASH')

# headers、cookies是一个省略模版，本地或者docker部署时对应替换
cookies = {
    'RK': 'oxEY1bTnXf',
    'ptcz': '53e3b35a9486dd63c4d06430b05aa169402117fc407dc5cc9329b41e59f62e2b',
    'pac_uid': '0_e63870bcecc18',
    'iip': '0',
    '_qimei_uuid42': '183070d3135100ee797b08bc922054dc3062834291',
    'wr_avatar': 'https%3A%2F%2Fthirdwx.qlogo.cn%2Fmmopen%2Fvi_32%2FeEOpSbFh2Mb1bUxMW9Y3FRPfXwWvOLaNlsjWIkcKeeNg6vlVS5kOVuhNKGQ1M8zaggLqMPmpE5qIUdqEXlQgYg%2F132',
    'wr_gender': '0',
}

headers = {
    'accept': 'application/json, text/plain, */*',
    'accept-language': 'zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,ko;q=0.5',
    'baggage': 'sentry-environment=production,sentry-release=dev-1730698697208,sentry-public_key=ed67ed71f7804a038e898ba54bd66e44,sentry-trace_id=1ff5a0725f8841088b42f97109c45862',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0',
}


"""
建议保留区域|默认读三体，其它书籍自行测试时间是否增加
"""
# data = {
#     "appId": "wb182564874663h152492176",
#     "b": "ce032b305a9bc1ce0b0dd2a",
#     "c": "7cb321502467cbbc409e62d",
#     "ci": 70,
#     "co": 0,
#     "sm": "[插图]第三部广播纪元7年，程心艾AA说",
#     "pr": 74,
#     "rt": 30,
#     "ts": 1727660516749,
#     "rn": 31,
#     "sg": "991118cc229871a5442993ecb08b5d2844d7f001dbad9a9bc7b2ecf73dc8db7e",
#     "ct": 1727660516,
#     "ps": "b1d32a307a4c3259g016b67",
#     "pc": "080327b07a4c3259g018787",
# }

dataArray = [
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"17e328b022b17e62166fad4","ci":25,"co":538,"sm":"[插图]轮转科室篇我在本院待了一年多，终","pr":60,"rt":39,"ts":1744285181952,"rn":35,"sg":"568ec40f68710c91c84e3153b8c732cbbabe0b9fadf40e86a78790b92fa39046","ct":1744285181,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"c9e8f7ee"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":2081,"sm":"了救护车。他母亲还特意交代我，不要给他输","pr":61,"rt":57,"ts":1744285337958,"rn":568,"sg":"ec1b25ebba5c9d4a06cb0f4a6ca9bf2bb967fa8964df72b6b0a13694ef15dea2","ct":1744285337,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"22d7eb46"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":3170,"sm":"也没有退路，不是天生勇敢，却在不断勇敢，","pr":61,"rt":34,"ts":1744285379448,"rn":515,"sg":"e17b23629f2d0b3a84d760affa5eb116334f92f36d07b7582f3b2b0321368893","ct":1744285379,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"cbf869e2"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":4343,"sm":"今天凌晨四点多，急诊警报响了。我看了一下","pr":62,"rt":31,"ts":1744285417990,"rn":205,"sg":"8fef254b7abb4e99690763362705de23475c133a7b6983576766025bf6433cc3","ct":1744285417,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"f3cc8cd8"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":5489,"sm":"我问：​“什么情况？​”女人“哇”的一声","pr":62,"rt":35,"ts":1744285462456,"rn":753,"sg":"c51d19db99da8758a72769c24d3269e8ced7156f801bc436c9416ee3ffd24865","ct":1744285462,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"6519202e"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":6644,"sm":"碗豆浆给女儿喝。我在整理急救包里面的物品","pr":62,"rt":31,"ts":1744285502761,"rn":3,"sg":"e483c301c0c2c5b4896f47f88c817f72fcdd6c1228b640da051954335269ae22","ct":1744285502,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"97292cda"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":7823,"sm":"我追问：​“是不是遇到什么事了？出大医疗","pr":63,"rt":31,"ts":1744285540666,"rn":159,"sg":"fe1f2ac6705237eb51160642bed2b974c540b8fee033948aa4f27aa7934ece96","ct":1744285540,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"713b8cea"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":9033,"sm":"我有点感动，果然，只有魔法才能打败魔法。","pr":63,"rt":34,"ts":1744285582679,"rn":243,"sg":"c9d442a630829f65c9c53e91b243bd43ea7d03db1833102c40b0b7318d770342","ct":1744285582,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"c747aa74"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":10244,"sm":"因为我没有放假而免遭急性胃肠炎的困扰，现","pr":64,"rt":41,"ts":1744285633414,"rn":305,"sg":"a03d6d5c2e36f632f76f2fe681a8183d75afe175b148129d3d01df168cd53135","ct":1744285633,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"bc40c07b"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":11366,"sm":"不过，常在河边走，哪有不湿鞋？今天他就碰","pr":64,"rt":30,"ts":1744285663770,"rn":464,"sg":"ea6c3761ae0994be02a4ebf7672ed796923dfd31959c4c752a75b17d81e61307","ct":1744285663,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"bfc6fe43"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":12531,"sm":"到了老太太家里，我们发现她已经昏迷不醒了","pr":65,"rt":30,"ts":1744285694139,"rn":773,"sg":"a1d283862a15fb7cdb44f165a318116dd91cea2aa85c26290fabcfaa242261ee","ct":1744285694,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"b05b26d7"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":13738,"sm":"在急诊外科轮转，本来以为今天上午不会收住","pr":65,"rt":30,"ts":1744285724508,"rn":444,"sg":"9876beb322975abf028061d0fa0b2448267a855a47bd96a0ca856e5b6d5f8820","ct":1744285724,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"b87fdd8d"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"02e32f0021b02e74f10ece8","ci":26,"co":14777,"sm":"“这个手术很危险吗？​”“谈不上大危险，","pr":66,"rt":30,"ts":1744285754867,"rn":269,"sg":"ec07c7ebab5f595a1af9c81d6abf850c3d98080fca01fc3428a960307b17e907","ct":1744285754,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"878fc2e8"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":338,"sm":"妇产科：每一位女性都应该先爱自己1妇产科","pr":66,"rt":30,"ts":1744285785213,"rn":249,"sg":"fbac24bcf31893896c69c127bb2fc898da30a788f4e2b9d13773802f4bac078b","ct":1744285785,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"b9060def"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":1512,"sm":"巢，在医生的建议下，陈女士在该院做了宫腹","pr":67,"rt":30,"ts":1744285815574,"rn":564,"sg":"98ca08ff312570db95567f8febd05bd90bbd3d55c995083613ede9ba643ea39f","ct":1744285815,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"65a7e57a"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":2624,"sm":"有时觉得当医生挺苦的，有值不完的夜班，写","pr":67,"rt":30,"ts":1744285845948,"rn":947,"sg":"41e390eb356ea11c74af185e4362360eda4414416f12cf85439088087853f7dc","ct":1744285845,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"915e2ebe"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":3782,"sm":"但是仔细一想，就知道这个问题有多荒唐了。","pr":67,"rt":30,"ts":1744285876315,"rn":261,"sg":"b219f9c7c6b3870627234d469667120a833aa3f6e99371598a8197ed2648ea70","ct":1744285876,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"1dea1842"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":4932,"sm":"女人没再多说什么，回到了自己的病房，随后","pr":68,"rt":30,"ts":1744285906693,"rn":766,"sg":"0262af0f80d23ca90117e3029b2324645091ec799330b2ee90c47ada868adc86","ct":1744285906,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"59387300"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":6088,"sm":"我赶紧麻利开单，生怕战火烧到我这边。两个","pr":68,"rt":35,"ts":1744286025948,"rn":644,"sg":"f0c07778e54dabe556e7303942f43b63c50ea0587574421935f32f4f41a5a3c0","ct":1744286025,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"cb675a2e"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":7214,"sm":"患者一听慌了，说：​“有瘤子呀，不行，不","pr":69,"rt":30,"ts":1744286056333,"rn":681,"sg":"d0439059587067f23d370ec2b9fef3c4c4965be4e9c46e80d13a036858c88015","ct":1744286056,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"a8fe0752"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":8356,"sm":"晚辈的相处方式。刘碧华就是典型的互联网大","pr":69,"rt":30,"ts":1744286086698,"rn":6,"sg":"b0eaf3743b50476c6537ff367a3a46091dee9eaddc4111ad2e366520b8fee8b3","ct":1744286086,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"98aa7e9a"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":9481,"sm":"如果它的官网排在那些搜索引擎的前面，那肯","pr":69,"rt":30,"ts":1744286117079,"rn":730,"sg":"a0d3f1159a9c5cfb40b273b2aebb020b22c031736f3e5fb448f146a7e33b6a87","ct":1744286117,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"42acd1f6"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":10627,"sm":"我眉毛舒展，笑着说：​“怀孕了，恭喜你们","pr":70,"rt":30,"ts":1744286147448,"rn":261,"sg":"54e1afdfd14fa165bbf329200d881b0e78ee05e69acd72e5b11f4ec732bfd98c","ct":1744286147,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"4830ec27"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":11767,"sm":"一波未平一波又起。随后，来了一个支原体感","pr":70,"rt":30,"ts":1744286177804,"rn":698,"sg":"38310440a1fe9c958b1524c4f423d8b1611466a9aabdf71ed52fbbbbebad04bb","ct":1744286177,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"7e8be2eb"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":12844,"sm":"正常。避年，一年来一次月经，有正常排卵，","pr":71,"rt":30,"ts":1744286208174,"rn":948,"sg":"377434bd01b275bc9f0fd73d4d5b149eb061533b62c331249b4dff908c0ae002","ct":1744286208,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"98be1306"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"33e3289021c33e75ff09694","ci":27,"co":13892,"sm":"半大不小的小伙子，确实不容易。老太太说：","pr":71,"rt":30,"ts":1744286238540,"rn":316,"sg":"f21ed1ed7f988153bcfbdcb60e02dec8b5512304eeab18d78a306e58266bf381","ct":1744286238,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"5d322455"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"6ea321b021d6ea9ab1ba605","ci":28,"co":338,"sm":"儿科：最紧张的医患关系与最温柔的医生12","pr":72,"rt":30,"ts":1744286268890,"rn":734,"sg":"f3a2f1f8170797bae00e7686e8d461620e3f4194d1ee1a7354b3e2c977ec8a7d","ct":1744286268,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"f2c23aa5"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"6ea321b021d6ea9ab1ba605","ci":28,"co":1521,"sm":"不配合，不能打！”我在心里嘀咕着，要不我","pr":72,"rt":30,"ts":1744286299259,"rn":584,"sg":"e9a248a1d8d27dd20ce99ce0f5e6b2095593505e2548939a3d04a968d121dc01","ct":1744286299,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"5641b356"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"6ea321b021d6ea9ab1ba605","ci":28,"co":2634,"sm":"合十分困难。过了两周，伤口周围仍旧轻微渗","pr":72,"rt":30,"ts":1744286329630,"rn":856,"sg":"fa0e233915924fc25bb4ad2d657f22f38c21c5a009af1a8c9440c10d5e718cd2","ct":1744286329,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"bebe053a"},
    {"appId":"wb182564874663h1484727348","b":"cf232020813ab9051g017394","c":"6ea321b021d6ea9ab1ba605","ci":28,"co":3751,"sm":"了一脚，泪珠竟然从眼眶滑落下来。当时，我","pr":73,"rt":30,"ts":1744286390417,"rn":590,"sg":"691703aed89363e78f001a47efc7cebaf149239a1511c81e59590ec1cc85ad22","ct":1744286390,"ps":"37a32b307a65915dg0198af","pc":"560325e07a65915eg012927","s":"72904ace"}
]


def convert(curl_command):
    """提取bash接口中的headers与cookies
    支持 -H 'Cookie: xxx' 和 -b 'xxx' 两种方式的cookie提取
    """
    # 提取 headers
    headers_temp = {}
    for match in re.findall(r"-H '([^:]+): ([^']+)'", curl_command):
        headers_temp[match[0]] = match[1]

    # 提取 cookies
    cookies = {}
    
    # 从 -H 'Cookie: xxx' 提取
    cookie_header = next((v for k, v in headers_temp.items() 
                         if k.lower() == 'cookie'), '')
    
    # 从 -b 'xxx' 提取
    cookie_b = re.search(r"-b '([^']+)'", curl_command)
    cookie_string = cookie_b.group(1) if cookie_b else cookie_header
    
    # 解析 cookie 字符串
    if cookie_string:
        for cookie in cookie_string.split('; '):
            if '=' in cookie:
                key, value = cookie.split('=', 1)
                cookies[key.strip()] = value.strip()
    
    # 移除 headers 中的 Cookie/cookie
    headers = {k: v for k, v in headers_temp.items() 
              if k.lower() != 'cookie'}

    return headers, cookies


headers, cookies = convert(curl_str) if curl_str else (headers, cookies)
